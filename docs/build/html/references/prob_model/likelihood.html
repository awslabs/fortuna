
<!DOCTYPE html>

<html lang="en">
<head>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<meta charset="utf-8"/>
<meta content="Docutils 0.19: https://docutils.sourceforge.io/" name="generator"/>
<title>Likelihood function | Fortuna's documentation</title>
<link href="../../_static/pygments.css" rel="stylesheet"/>
<link href="../../_static/theme.9297a650d9dd3016d913.css" rel="stylesheet"/>
<link href="../../_static/sg_gallery.css" rel="stylesheet"/>
<link href="../../_static/sg_gallery.css" rel="stylesheet"/>
<link href="../../search.html" rel="search" title="Search"/>
<link href="../../genindex.html" rel="index" title="Index"/>
<link href="prior.html" rel="next" title="Prior distribution"/>
<link href="joint.html" rel="prev" title="Joint distribution"/>
</head>
<body class="antialiased text-gray scroll-smooth">
<div class="min-h-screen xl:h-screen flex flex-col xl:grid xl:grid-layout print:block print:h-auto" data-action="keydown@window-&gt;search#focus " data-controller="sidebar search " id="page">
<a class="block transition -translate-x-full focus:translate-x-0 opacity-0 focus:opacity-100 text-xl bg-white p-4 z-20 absolute top-0 left-0 h-14" href="#likelihood-function" title="Skip navigation links">Skip to content</a>
<header class="grid-area-header z-10 h-14 fixed w-full top-0 print:hidden">
<div class="bg-gray-dark shadow-md flex items-center h-full xl:px-2 relative"><div class="flex items-center">
<button class="xl:hidden h-14 w-14 leading-14 text-gray-100 hover:bg-gray-700 hover:text-brand focus:outline-none focus:bg-gray-700 focus:text-brand" data-action="sidebar#open" data-sidebar-target="hamburger">
<span class="sr-only">Open navigation menu</span>
<svg aria-hidden="true" class="fill-current h-8 w-8" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"></path></svg>
</button><a class="hover:bg-gray-700 focus:bg-gray-700 focus:outline-none" href="../../index.html" title="Back to homepage"><img alt="Logo" class="h-14 w-14 p-3 inline-block" src="../../_static/fortuna_symbol_white.png"/><span class="hidden lg:inline-block shrink-0 font-medium text-gray-100 mx-5 leading-14 tracking-wider">Fortuna's documentation</span>
</a></div><div class="flex justify-end items-center flex-1"><form action="../../search.html" class="flex print:hidden justify-between items-center leading-14 md:ml-4 bg-gray-dark text-gray-300 focus-within:bg-gray-50 focus-within:text-gray-800 focus-within:absolute focus-within:inset-x-0 focus-within:top-0 md:focus-within:w-full md:focus-within:static z-10" data-action="click-&gt;search#focusSearchInput" id="searchbox" method="get">
<button aria-label="Get search results" class="text-inherit h-14 w-14" tabindex="-1">
<svg aria-hidden="true" class="fill-current stroke-current h-8 w-8" stroke-width="0.5" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M15.5 14h-.79l-.28-.27A6.471 6.471 0 0016 9.5 6.5 6.5 0 109.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"></path></svg>
</button>
<input aria-label="Search the docs" class="pr-2 bg-transparent text-inherit focus:outline-none w-0 md:w-auto focus:w-full transition-all duration-100" data-search-target="searchInput" id="search-input" name="q" placeholder="Search the docs" type="search"/>
</form></div>
</div>
</header>
<aside class="grid-area-sidebar h-full fixed pt-14 xl:relative inset-y-0 left-0 z-20 xl:z-0 print:hidden overflow-y-auto transition-all transform transform-gpu -translate-x-full opacity-0 duration-300 xl:translate-x-0 xl:opacity-100" data-sidebar-target="sidebar">
<nav class="h-full overflow-y-auto bg-white text-gray-600 pt-8 flex flex-col" role="navigation">
<div class="nav-toc flex-1 pl-6"><p class="caption" role="heading"><span class="caption-text">CONTENTS:</span></p>
<ul class="current">
<li class="toctree-l1"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../../quickstart.html">Quickstart</a></div></li>
<li class="toctree-l1"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../../installation.html">Installation</a></div></li>
<li class="toctree-l1"><div class="nav-link"><svg class="expand" data-action="click-&gt;sidebar#expand keydown-&gt;sidebar#expandKeyPressed" tabindex="0" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg><a class="reference internal" data-action="click-&gt;sidebar#close" href="../../examples/examples.html">Examples</a></div><ul>
<li class="toctree-l2"><div class="nav-link"><svg class="expand" data-action="click-&gt;sidebar#expand keydown-&gt;sidebar#expandKeyPressed" tabindex="0" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg><a class="reference internal" data-action="click-&gt;sidebar#close" href="../../examples/mnist_classification.html">MNIST Classification</a></div><ul>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../../examples/mnist_classification.html#Download-MNIST-data-from-TensorFlow">Download MNIST data from TensorFlow</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../../examples/mnist_classification.html#Convert-data-to-a-compatible-data-loader">Convert data to a compatible data loader</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../../examples/mnist_classification.html#Build-a-probabilistic-classifier">Build a probabilistic classifier</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../../examples/mnist_classification.html#Train-the-probabilistic-model:-posterior-fitting-and-calibration">Train the probabilistic model: posterior fitting and calibration</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../../examples/mnist_classification.html#Estimate-predictive-statistics">Estimate predictive statistics</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../../examples/mnist_classification.html#Compute-metrics">Compute metrics</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../../examples/mnist_classification.html#Conformal-prediction-sets">Conformal prediction sets</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../../examples/mnist_classification.html#What-if-we-had-had-model-outputs-to-start-from?">What if we had had model outputs to start from?</a></div></li>
</ul>
</li>
<li class="toctree-l2"><div class="nav-link"><svg class="expand" data-action="click-&gt;sidebar#expand keydown-&gt;sidebar#expandKeyPressed" tabindex="0" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg><a class="reference internal" data-action="click-&gt;sidebar#close" href="../../examples/sinusoidal_regression.html">Sinusoidal regression</a></div><ul>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../../examples/sinusoidal_regression.html#Generate-the-data">Generate the data</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../../examples/sinusoidal_regression.html#Convert-data-to-a-compatible-data-loader">Convert data to a compatible data loader</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../../examples/sinusoidal_regression.html#Build-a-probabilistic-regressor">Build a probabilistic regressor</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../../examples/sinusoidal_regression.html#Train-the-probabilistic-model:-posterior-fitting-and-calibration">Train the probabilistic model: posterior fitting and calibration</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../../examples/sinusoidal_regression.html#Estimate-predictive-statistics">Estimate predictive statistics</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../../examples/sinusoidal_regression.html#Compute-metrics">Compute metrics</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../../examples/sinusoidal_regression.html#Conformal-intervals">Conformal intervals</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../../examples/sinusoidal_regression.html#What-if-we-had-had-model-outputs-to-start-from?">What if we had had model outputs to start from?</a></div></li>
</ul>
</li>
<li class="toctree-l2"><div class="nav-link"><svg class="expand" data-action="click-&gt;sidebar#expand keydown-&gt;sidebar#expandKeyPressed" tabindex="0" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg><a class="reference internal" data-action="click-&gt;sidebar#close" href="../../examples/two_moons_classification.html">Two-moons Classification</a></div><ul>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../../examples/two_moons_classification.html#Download-Two-Moons-data-from-scikit-learn">Download Two-Moons data from scikit-learn</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../../examples/two_moons_classification.html#Convert-data-to-a-compatible-data-loader">Convert data to a compatible data loader</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../../examples/two_moons_classification.html#Build-a-probabilistic-classifier">Build a probabilistic classifier</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../../examples/two_moons_classification.html#Train-the-probabilistic-model:-posterior-fitting-and-calibration">Train the probabilistic model: posterior fitting and calibration</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../../examples/two_moons_classification.html#Estimate-predictive-statistics">Estimate predictive statistics</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../../examples/two_moons_classification.html#Compute-metrics">Compute metrics</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../../examples/two_moons_classification.html#What-if-we-had-had-model-outputs-to-start-from?">What if we had had model outputs to start from?</a></div></li>
</ul>
</li>
<li class="toctree-l2"><div class="nav-link"><svg class="expand" data-action="click-&gt;sidebar#expand keydown-&gt;sidebar#expandKeyPressed" tabindex="0" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg><a class="reference internal" data-action="click-&gt;sidebar#close" href="../../examples/tabular_regressions.html">Tabular regressions</a></div><ul>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../../examples/tabular_regressions.html#Download-regression-datasets-from-UCI">Download regression datasets from UCI</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../../examples/tabular_regressions.html#Regression-on-each-data-set">Regression on each data set</a></div></li>
</ul>
</li>
<li class="toctree-l2"><div class="nav-link"><svg class="expand" data-action="click-&gt;sidebar#expand keydown-&gt;sidebar#expandKeyPressed" tabindex="0" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg><a class="reference internal" data-action="click-&gt;sidebar#close" href="../../examples/bring_in_your_own.html">Bring in your own objects</a></div><ul>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../../examples/bring_in_your_own.html#Bring-in-your-own-model">Bring in your own model</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../../examples/bring_in_your_own.html#Bring-in-your-own-prior-distribution">Bring in your own prior distribution</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../../examples/bring_in_your_own.html#Bring-in-your-own-output-calibrator">Bring in your own output calibrator</a></div></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><div class="nav-link"><svg class="expand" data-action="click-&gt;sidebar#expand keydown-&gt;sidebar#expandKeyPressed" tabindex="0" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg><a class="reference internal" data-action="click-&gt;sidebar#close" href="../../usage_modes/usage_modes.html">Usage modes</a></div><ul>
<li class="toctree-l2"><div class="nav-link"><svg class="expand" data-action="click-&gt;sidebar#expand keydown-&gt;sidebar#expandKeyPressed" tabindex="0" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg><a class="reference internal" data-action="click-&gt;sidebar#close" href="../../usage_modes/uncertainty_estimates.html">From uncertainty estimates</a></div><ul>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../../usage_modes/uncertainty_estimates.html#classification">Classification</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../../usage_modes/uncertainty_estimates.html#regression">Regression</a></div></li>
</ul>
</li>
<li class="toctree-l2"><div class="nav-link"><svg class="expand" data-action="click-&gt;sidebar#expand keydown-&gt;sidebar#expandKeyPressed" tabindex="0" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg><a class="reference internal" data-action="click-&gt;sidebar#close" href="../../usage_modes/model_outputs.html">From model outputs</a></div><ul>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../../usage_modes/model_outputs.html#classification">Classification</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../../usage_modes/model_outputs.html#regression">Regression</a></div></li>
</ul>
</li>
<li class="toctree-l2"><div class="nav-link"><svg class="expand" data-action="click-&gt;sidebar#expand keydown-&gt;sidebar#expandKeyPressed" tabindex="0" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg><a class="reference internal" data-action="click-&gt;sidebar#close" href="../../usage_modes/flax_models.html">From Flax models</a></div><ul>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../../usage_modes/flax_models.html#classification">Classification</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../../usage_modes/flax_models.html#regression">Regression</a></div></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current expanded"><div class="nav-link"><svg class="expand" data-action="click-&gt;sidebar#expand keydown-&gt;sidebar#expandKeyPressed" tabindex="0" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg><a class="reference internal" data-action="click-&gt;sidebar#close" href="../references.html">API References</a></div><ul class="current">
<li class="toctree-l2 current expanded"><div class="nav-link"><svg class="expand" data-action="click-&gt;sidebar#expand keydown-&gt;sidebar#expandKeyPressed" tabindex="0" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg><a class="reference internal" data-action="click-&gt;sidebar#close" href="prob_model.html">Probabilistic model</a></div><ul class="current">
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="prob_model.html#fortuna.prob_model.classification.ProbClassifier"><code class="docutils literal notranslate">ProbClassifier</code></a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="prob_model.html#fortuna.prob_model.regression.ProbRegressor"><code class="docutils literal notranslate">ProbRegressor</code></a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="prob_model.html#fortuna.prob_model.base.ProbModel"><code class="docutils literal notranslate">ProbModel</code></a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="predictive.html">Predictive distribution</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="posterior/posterior.html">Posterior</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="joint.html">Joint distribution</a></div></li>
<li class="toctree-l3 current expanded"><div class="nav-link"><a class="current reference internal" data-action="click-&gt;sidebar#close" href="#">Likelihood function</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="prior.html">Prior distribution</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="fit_config.html">Posterior fitting configuration</a></div></li>
</ul>
</li>
<li class="toctree-l2"><div class="nav-link"><svg class="expand" data-action="click-&gt;sidebar#expand keydown-&gt;sidebar#expandKeyPressed" tabindex="0" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg><a class="reference internal" data-action="click-&gt;sidebar#close" href="../calib_model/calib_model.html">Calibration model</a></div><ul>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../calib_model/calib_model.html#fortuna.calib_model.classification.CalibClassifier"><code class="docutils literal notranslate">CalibClassifier</code></a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../calib_model/calib_model.html#fortuna.calib_model.regression.CalibRegressor"><code class="docutils literal notranslate">CalibRegressor</code></a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../calib_model/calib_model.html#fortuna.calib_model.base.CalibModel"><code class="docutils literal notranslate">CalibModel</code></a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../calib_model/predictive.html">Predictive distribution</a></div></li>
</ul>
</li>
<li class="toctree-l2"><div class="nav-link"><svg class="expand" data-action="click-&gt;sidebar#expand keydown-&gt;sidebar#expandKeyPressed" tabindex="0" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg><a class="reference internal" data-action="click-&gt;sidebar#close" href="../model/model.html">Model</a></div><ul>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../model/builtin_models.html">Built-in models</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../model/linen_module.html">Flax Linen Module</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../model/model_manager.html">Model manager</a></div></li>
</ul>
</li>
<li class="toctree-l2"><div class="nav-link"><svg class="expand" data-action="click-&gt;sidebar#expand keydown-&gt;sidebar#expandKeyPressed" tabindex="0" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg><a class="reference internal" data-action="click-&gt;sidebar#close" href="../output_calibrator.html">Output calibrator</a></div><ul>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../output_calibrator.html#fortuna.output_calibrator.classification.ClassificationTemperatureScaler"><code class="docutils literal notranslate">ClassificationTemperatureScaler</code></a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../output_calibrator.html#fortuna.output_calibrator.regression.RegressionTemperatureScaler"><code class="docutils literal notranslate">RegressionTemperatureScaler</code></a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../output_calibrator.html#fortuna.training.calib_state.CalibState"><code class="docutils literal notranslate">CalibState</code></a></div></li>
</ul>
</li>
<li class="toctree-l2"><div class="nav-link"><svg class="expand" data-action="click-&gt;sidebar#expand keydown-&gt;sidebar#expandKeyPressed" tabindex="0" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg><a class="reference internal" data-action="click-&gt;sidebar#close" href="../prob_output_layer.html">Probabilistic output layer</a></div><ul>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../prob_output_layer.html#fortuna.prob_output_layer.base.ProbOutputLayer"><code class="docutils literal notranslate">ProbOutputLayer</code></a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../prob_output_layer.html#fortuna.prob_output_layer.classification.ClassificationProbOutputLayer"><code class="docutils literal notranslate">ClassificationProbOutputLayer</code></a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../prob_output_layer.html#fortuna.prob_output_layer.regression.RegressionProbOutputLayer"><code class="docutils literal notranslate">RegressionProbOutputLayer</code></a></div></li>
</ul>
</li>
<li class="toctree-l2"><div class="nav-link"><svg class="expand" data-action="click-&gt;sidebar#expand keydown-&gt;sidebar#expandKeyPressed" tabindex="0" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg><a class="reference internal" data-action="click-&gt;sidebar#close" href="../calib_config.html">Calibration configuration</a></div><ul>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../calib_config.html#fortuna.calib_config.base.CalibConfig"><code class="docutils literal notranslate">CalibConfig</code></a></div></li>
</ul>
</li>
<li class="toctree-l2"><div class="nav-link"><svg class="expand" data-action="click-&gt;sidebar#expand keydown-&gt;sidebar#expandKeyPressed" tabindex="0" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg><a class="reference internal" data-action="click-&gt;sidebar#close" href="../conformer.html">Conformer</a></div><ul>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../conformer.html#fortuna.conformer.classification.AdaptivePredictionConformalClassifier"><code class="docutils literal notranslate">AdaptivePredictionConformalClassifier</code></a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../conformer.html#fortuna.conformer.classification.SimplePredictionConformalClassifier"><code class="docutils literal notranslate">SimplePredictionConformalClassifier</code></a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../conformer.html#fortuna.conformer.regression.OneDimensionalUncertaintyConformalRegressor"><code class="docutils literal notranslate">OneDimensionalUncertaintyConformalRegressor</code></a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../conformer.html#fortuna.conformer.regression.QuantileConformalRegressor"><code class="docutils literal notranslate">QuantileConformalRegressor</code></a></div></li>
</ul>
</li>
<li class="toctree-l2"><div class="nav-link"><svg class="expand" data-action="click-&gt;sidebar#expand keydown-&gt;sidebar#expandKeyPressed" tabindex="0" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg><a class="reference internal" data-action="click-&gt;sidebar#close" href="../data_loader.html">Data loader</a></div><ul>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../data_loader.html#fortuna.data.loader.DataLoader"><code class="docutils literal notranslate">DataLoader</code></a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../data_loader.html#fortuna.data.loader.InputsLoader"><code class="docutils literal notranslate">InputsLoader</code></a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../data_loader.html#fortuna.data.loader.TargetsLoader"><code class="docutils literal notranslate">TargetsLoader</code></a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../data_loader.html#fortuna.data.loader.FromIterableToDataLoader"><code class="docutils literal notranslate">FromIterableToDataLoader</code></a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../data_loader.html#fortuna.data.loader.FromCallableIterableToDataLoader"><code class="docutils literal notranslate">FromCallableIterableToDataLoader</code></a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../data_loader.html#fortuna.data.loader.FromArrayDataToDataLoader"><code class="docutils literal notranslate">FromArrayDataToDataLoader</code></a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../data_loader.html#fortuna.data.loader.FromArrayInputsToInputsLoader"><code class="docutils literal notranslate">FromArrayInputsToInputsLoader</code></a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../data_loader.html#fortuna.data.loader.FromDataLoaderToInputsLoader"><code class="docutils literal notranslate">FromDataLoaderToInputsLoader</code></a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../data_loader.html#fortuna.data.loader.FromArrayTargetsToTargetsLoader"><code class="docutils literal notranslate">FromArrayTargetsToTargetsLoader</code></a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../data_loader.html#fortuna.data.loader.FromDataLoaderToTargetsLoader"><code class="docutils literal notranslate">FromDataLoaderToTargetsLoader</code></a></div></li>
</ul>
</li>
<li class="toctree-l2"><div class="nav-link"><svg class="expand" data-action="click-&gt;sidebar#expand keydown-&gt;sidebar#expandKeyPressed" tabindex="0" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg><a class="reference internal" data-action="click-&gt;sidebar#close" href="../metric.html">Metric</a></div><ul>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../metric.html#fortuna.metric.classification.accuracy"><code class="docutils literal notranslate">accuracy()</code></a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../metric.html#fortuna.metric.classification.brier_score"><code class="docutils literal notranslate">brier_score()</code></a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../metric.html#fortuna.metric.classification.ece"><code class="docutils literal notranslate">ece()</code></a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../metric.html#fortuna.metric.classification.expected_calibration_error"><code class="docutils literal notranslate">expected_calibration_error()</code></a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../metric.html#fortuna.metric.classification.maximum_calibration_error"><code class="docutils literal notranslate">maximum_calibration_error()</code></a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../metric.html#fortuna.metric.classification.mce"><code class="docutils literal notranslate">mce()</code></a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../metric.html#fortuna.metric.regression.mae"><code class="docutils literal notranslate">mae()</code></a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../metric.html#fortuna.metric.regression.mean_absolute_error"><code class="docutils literal notranslate">mean_absolute_error()</code></a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../metric.html#fortuna.metric.regression.mean_squared_error"><code class="docutils literal notranslate">mean_squared_error()</code></a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../metric.html#fortuna.metric.regression.mse"><code class="docutils literal notranslate">mse()</code></a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../metric.html#fortuna.metric.regression.picp"><code class="docutils literal notranslate">picp()</code></a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../metric.html#fortuna.metric.regression.prediction_interval_coverage_probability"><code class="docutils literal notranslate">prediction_interval_coverage_probability()</code></a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../metric.html#fortuna.metric.regression.rmae"><code class="docutils literal notranslate">rmae()</code></a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../metric.html#fortuna.metric.regression.rmse"><code class="docutils literal notranslate">rmse()</code></a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../metric.html#fortuna.metric.regression.root_mean_absolute_error"><code class="docutils literal notranslate">root_mean_absolute_error()</code></a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../metric.html#fortuna.metric.regression.root_mean_squared_error"><code class="docutils literal notranslate">root_mean_squared_error()</code></a></div></li>
</ul>
</li>
<li class="toctree-l2"><div class="nav-link"><svg class="expand" data-action="click-&gt;sidebar#expand keydown-&gt;sidebar#expandKeyPressed" tabindex="0" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg><a class="reference internal" data-action="click-&gt;sidebar#close" href="../utils.html">Utils</a></div><ul>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../utils.html#fortuna.utils.random.RandomNumberGenerator"><code class="docutils literal notranslate">RandomNumberGenerator</code></a></div></li>
</ul>
</li>
<li class="toctree-l2"><div class="nav-link"><svg class="expand" data-action="click-&gt;sidebar#expand keydown-&gt;sidebar#expandKeyPressed" tabindex="0" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg><a class="reference internal" data-action="click-&gt;sidebar#close" href="../plot.html">Plot</a></div><ul>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../plot.html#fortuna.plot.plot_reliability_diagram"><code class="docutils literal notranslate">plot_reliability_diagram()</code></a></div></li>
</ul>
</li>
<li class="toctree-l2"><div class="nav-link"><svg class="expand" data-action="click-&gt;sidebar#expand keydown-&gt;sidebar#expandKeyPressed" tabindex="0" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg><a class="reference internal" data-action="click-&gt;sidebar#close" href="../typing.html">Typing</a></div><ul>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../typing.html#fortuna.typing.Array"><code class="docutils literal notranslate">Array</code></a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../typing.html#fortuna.typing.Batch"><code class="docutils literal notranslate">Batch</code></a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../typing.html#fortuna.typing.Params"><code class="docutils literal notranslate">Params</code></a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../typing.html#fortuna.typing.Mutable"><code class="docutils literal notranslate">Mutable</code></a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../typing.html#fortuna.typing.Path"><code class="docutils literal notranslate">Path</code></a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../typing.html#fortuna.typing.OptaxOptimizer"><code class="docutils literal notranslate">OptaxOptimizer</code></a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../typing.html#fortuna.typing.CalibParams"><code class="docutils literal notranslate">CalibParams</code></a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../typing.html#fortuna.typing.CalibMutable"><code class="docutils literal notranslate">CalibMutable</code></a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../typing.html#fortuna.typing.Status"><code class="docutils literal notranslate">Status</code></a></div></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<button class="text-4xl text-gray-800 p-4 bottom-0 hover:text-brand xl:hidden focus:text-brand self-center" data-action="sidebar#close" title="Close navigation menu">
<span class="sr-only">Close navigation menu</span>
<svg aria-hidden="true" class="fill-current stroke-current h-6 w-6" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg>
</button>
</nav>
</aside>
<main class="px-4 pt-14 xl:ml-fluid grid-area-main overflow-y-auto flex flex-col flex-1 h-full mx-0 md:mx-auto xl:mr-0"><nav aria-label="breadcrumbs" class="print:hidden mt-12 text-sm text-gray-light" role="navigation">
<a class="text-gray-light text-sm hover:text-gray-dark font-medium focus:text-gray-dark" href="../../index.html">Fortuna's documentation</a>
<span class="mr-1">/</span><a class="text-gray-light text-sm hover:text-gray-dark" href="../references.html">API References</a>
<span class="mr-1">/</span><a class="text-gray-light text-sm hover:text-gray-dark" href="prob_model.html">Probabilistic model</a>
<span class="mr-1">/</span><span aria-current="page">Likelihood function</span>
</nav>
<article class="flex-1" role="main">
<section id="likelihood-function">
<h1>Likelihood function<a aria-label="Click to copy this link" class="headerlink tooltipped tooltipped-ne" data-action="click-&gt;clipboard#copyHeaderLink" data-controller="clipboard" href="#likelihood-function">¶</a></h1>
<p>The likelihood function models the target data given the model and the input data.
We support a <a class="reference internal" href="#likelihood-classification"><span class="std std-ref">classification likelihood</span></a> for classification and a
<a class="reference internal" href="#likelihood-regression"><span class="std std-ref">regression likelihood</span></a> for regression. Please find their references below.</p>
<span class="target" id="module-fortuna.prob_model.likelihood.classification"><span id="likelihood-classification"></span></span><dl class="py class code-definition">
<dt class="sig sig-object py" id="fortuna.prob_model.likelihood.classification.ClassificationLikelihood">
<em class="property">class<span class="w"> </span></em><code class="sig-prename descclassname">fortuna.prob_model.likelihood.classification.</code><code class="sig-name descname">ClassificationLikelihood</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model_manager</span></em>, <em class="sig-param"><span class="n">prob_output_layer</span></em>, <em class="sig-param"><span class="n">output_calib_manager</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/fortuna/prob_model/likelihood/classification.html#ClassificationLikelihood"><span class="viewcode-link">[source]</span></a><a aria-label="Click to copy this link" class="headerlink tooltipped tooltipped-ne" data-action="click-&gt;clipboard#copyHeaderLink" data-controller="clipboard" href="#fortuna.prob_model.likelihood.classification.ClassificationLikelihood">¶</a></dt>
<dd>
<p>A classification likelihood function class. In this class, the likelihood function is additionally assumed to
be a probability density function, i.e. positive and integrating to 1. The likelihood is formed by three
objects applied in sequence: the model manager, the output calibrator and the probabilistic output layer. The
model manager maps parameters and inputs to outputs. The output calibration takes outputs and returns some
calibrated version of them. The probabilistic output layer describes the probability distribution of the
calibrated outputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_manager</strong> (<a class="reference internal" href="../model/model_manager.html#fortuna.model.model_manager.base.ModelManager" title="fortuna.model.model_manager.base.ModelManager"><em>ModelManager</em></a>) – An model manager. This objects orchestrates the evaluation of the models.</p></li>
<li><p><strong>prob_output_layer</strong> (<a class="reference internal" href="../prob_output_layer.html#fortuna.prob_output_layer.base.ProbOutputLayer" title="fortuna.prob_output_layer.base.ProbOutputLayer"><em>ProbOutputLayer</em></a>) – A probabilistic output layer object. This object characterizes the probability distribution of the
target variable given the calibrated outputs.</p></li>
<li><p><strong>output_calib_manager</strong> (<em>OutputCalibManager</em>) – An output calibration manager object. It transforms outputs of the model manager into some
calibrated version of them.</p></li>
</ul>
</dd>
</dl>
<dl class="py method code-definition">
<dt class="sig sig-object py" id="fortuna.prob_model.likelihood.classification.ClassificationLikelihood.entropy">
<code class="sig-name descname">entropy</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">params</span></em>, <em class="sig-param"><span class="n">inputs_loader</span></em>, <em class="sig-param"><span class="n">mutable</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">calib_params</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">calib_mutable</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/fortuna/prob_model/likelihood/classification.html#ClassificationLikelihood.entropy"><span class="viewcode-link">[source]</span></a><a aria-label="Click to copy this link" class="headerlink tooltipped tooltipped-ne" data-action="click-&gt;clipboard#copyHeaderLink" data-controller="clipboard" href="#fortuna.prob_model.likelihood.classification.ClassificationLikelihood.entropy">¶</a></dt>
<dd>
<p>Estimate the likelihood entropy, that is</p>
<div class="math notranslate nohighlight">
\[-\mathbb{E}_{Y|w,x}[\log p(Y|w,x)]\]</div>
<dl class="simple">
<dt>where:</dt><dd><ul class="simple">
<li><p><span class="math notranslate nohighlight">\(x\)</span> is an observed input variable;</p></li>
<li><p><span class="math notranslate nohighlight">\(Y\)</span> is a random target variable;</p></li>
<li><p><span class="math notranslate nohighlight">\(w\)</span> denotes the observed model parameters.</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<em>Params</em>) – The random parameters of the probabilistic model.</p></li>
<li><p><strong>inputs_loader</strong> (<a class="reference internal" href="../data_loader.html#fortuna.data.loader.InputsLoader" title="fortuna.data.loader.InputsLoader"><em>InputsLoader</em></a>) – A loader of input data points.</p></li>
<li><p><strong>mutable</strong> (<em>Optional</em><em>[</em><em>Mutable</em><em>]</em>) – The mutable objects used to evaluate the models.</p></li>
<li><p><strong>calib_params</strong> (<em>Optional</em><em>[</em><em>CalibParams</em><em>]</em>) – The calibration parameters of the probabilistic model.</p></li>
<li><p><strong>calib_mutable</strong> (<em>Optional</em><em>[</em><em>CalibMutable</em><em>]</em>) – The calibration mutable objects used to evaluate the calibrators.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>An estimate of the likelihood entropy for each input.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>jnp.ndarray</p>
</dd>
</dl>
</dd></dl>
<dl class="py method code-definition">
<dt class="sig sig-object py" id="fortuna.prob_model.likelihood.classification.ClassificationLikelihood.log_prob">
<code class="sig-name descname">log_prob</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">params</span></em>, <em class="sig-param"><span class="n">data_loader</span></em>, <em class="sig-param"><span class="n">mutable</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">calib_params</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">calib_mutable</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">return_aux</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">calib</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">outputs</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a aria-label="Click to copy this link" class="headerlink tooltipped tooltipped-ne" data-action="click-&gt;clipboard#copyHeaderLink" data-controller="clipboard" href="#fortuna.prob_model.likelihood.classification.ClassificationLikelihood.log_prob">¶</a></dt>
<dd>
<p>Evaluate the log-likelihood function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<em>Params</em>) – The random parameters of the probabilistic model.</p></li>
<li><p><strong>data_loader</strong> (<a class="reference internal" href="../data_loader.html#fortuna.data.loader.DataLoader" title="fortuna.data.loader.DataLoader"><em>DataLoader</em></a>) – A data loader.</p></li>
<li><p><strong>mutable</strong> (<em>Optional</em><em>[</em><em>Mutable</em><em>]</em>) – The mutable objects used to evaluate the models.</p></li>
<li><p><strong>calib_params</strong> (<em>Optional</em><em>[</em><em>CalibParams</em><em>]</em>) – The calibration parameters of the probabilistic model.</p></li>
<li><p><strong>calib_mutable</strong> (<em>Optional</em><em>[</em><em>CalibMutable</em><em>]</em>) – The calibration mutable objects used to evaluate the calibrators.</p></li>
<li><p><strong>return_aux</strong> (<em>Optional</em><em>[</em><em>List</em><em>[</em><em>str</em><em>]</em><em>]</em>) – The auxiliary objects to return. We support ‘outputs’ and ‘calib_mutable’. If this argument is not given,
no auxiliary object is returned.</p></li>
<li><p><strong>calib</strong> (<em>bool</em>) – Whether this method is called during calibration.</p></li>
<li><p><strong>outputs</strong> (<em>Optional</em><em>[</em><em>jnp.ndarray</em><em>]</em>) – Pre-computed batch of outputs.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The evaluation of the log-likelihood function. If <cite>return_aux</cite> is given, the corresponding auxiliary
objects are also returned.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Union[float, Tuple[float, dict]]</p>
</dd>
</dl>
</dd></dl>
<dl class="py method code-definition">
<dt class="sig sig-object py" id="fortuna.prob_model.likelihood.classification.ClassificationLikelihood.mean">
<code class="sig-name descname">mean</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">params</span></em>, <em class="sig-param"><span class="n">inputs_loader</span></em>, <em class="sig-param"><span class="n">mutable</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">calib_params</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">calib_mutable</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/fortuna/prob_model/likelihood/classification.html#ClassificationLikelihood.mean"><span class="viewcode-link">[source]</span></a><a aria-label="Click to copy this link" class="headerlink tooltipped tooltipped-ne" data-action="click-&gt;clipboard#copyHeaderLink" data-controller="clipboard" href="#fortuna.prob_model.likelihood.classification.ClassificationLikelihood.mean">¶</a></dt>
<dd>
<p>Estimate the likelihood mean of the one-hot encoded target variable, that is</p>
<div class="math notranslate nohighlight">
\[\mathbb{E}_{\tilde{Y}|w, x}[\tilde{Y}],\]</div>
<dl class="simple">
<dt>where:</dt><dd><ul class="simple">
<li><p><span class="math notranslate nohighlight">\(x\)</span> is an observed input variable;</p></li>
<li><p><span class="math notranslate nohighlight">\(\tilde{Y}\)</span> is a one-hot encoded random target variable;</p></li>
<li><p><span class="math notranslate nohighlight">\(w\)</span> denotes the observed model parameters.</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<em>Params</em>) – The random parameters of the probabilistic model.</p></li>
<li><p><strong>inputs_loader</strong> (<a class="reference internal" href="../data_loader.html#fortuna.data.loader.InputsLoader" title="fortuna.data.loader.InputsLoader"><em>InputsLoader</em></a>) – A loader of input data points.</p></li>
<li><p><strong>mutable</strong> (<em>Optional</em><em>[</em><em>Mutable</em><em>]</em>) – The mutable objects used to evaluate the models.</p></li>
<li><p><strong>calib_params</strong> (<em>Optional</em><em>[</em><em>CalibParams</em><em>]</em>) – The calibration parameters of the probabilistic model.</p></li>
<li><p><strong>calib_mutable</strong> (<em>Optional</em><em>[</em><em>CalibMutable</em><em>]</em>) – The calibration mutable objects used to evaluate the calibrators.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>An estimate of the likelihood mean for each input.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>jnp.ndarray</p>
</dd>
</dl>
</dd></dl>
<dl class="py method code-definition">
<dt class="sig sig-object py" id="fortuna.prob_model.likelihood.classification.ClassificationLikelihood.mode">
<code class="sig-name descname">mode</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">params</span></em>, <em class="sig-param"><span class="n">inputs_loader</span></em>, <em class="sig-param"><span class="n">mutable</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">calib_params</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">calib_mutable</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/fortuna/prob_model/likelihood/classification.html#ClassificationLikelihood.mode"><span class="viewcode-link">[source]</span></a><a aria-label="Click to copy this link" class="headerlink tooltipped tooltipped-ne" data-action="click-&gt;clipboard#copyHeaderLink" data-controller="clipboard" href="#fortuna.prob_model.likelihood.classification.ClassificationLikelihood.mode">¶</a></dt>
<dd>
<p>Estimate the likelihood mode of the target variable, that is</p>
<div class="math notranslate nohighlight">
\[\text{argmax}_y\ p(y|w, x),\]</div>
<dl class="simple">
<dt>where:</dt><dd><ul class="simple">
<li><p><span class="math notranslate nohighlight">\(x\)</span> is an observed input variable;</p></li>
<li><p><span class="math notranslate nohighlight">\(w\)</span> denotes the observed model parameters;</p></li>
<li><p><span class="math notranslate nohighlight">\(y\)</span> is the target variable to optimize upon.</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<em>Params</em>) – The random parameters of the probabilistic model.</p></li>
<li><p><strong>inputs_loader</strong> (<a class="reference internal" href="../data_loader.html#fortuna.data.loader.InputsLoader" title="fortuna.data.loader.InputsLoader"><em>InputsLoader</em></a>) – A loader of input data points.</p></li>
<li><p><strong>mutable</strong> (<em>Optional</em><em>[</em><em>Mutable</em><em>]</em>) – The mutable objects used to evaluate the models.</p></li>
<li><p><strong>calib_params</strong> (<em>Optional</em><em>[</em><em>CalibParams</em><em>]</em>) – The calibration parameters of the probabilistic model.</p></li>
<li><p><strong>calib_mutable</strong> (<em>Optional</em><em>[</em><em>CalibMutable</em><em>]</em>) – The calibration mutable objects used to evaluate the calibrators.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>An estimate of the likelihood mean for each input.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>jnp.ndarray</p>
</dd>
</dl>
</dd></dl>
<dl class="py property code-definition">
<dt class="sig sig-object py" id="fortuna.prob_model.likelihood.classification.ClassificationLikelihood.rng">
<em class="property">property<span class="w"> </span></em><code class="sig-name descname">rng</code><em class="property"><span class="p">:</span><span class="w"> </span><a class="reference internal" href="../utils.html#fortuna.utils.random.RandomNumberGenerator" title="fortuna.utils.random.RandomNumberGenerator">RandomNumberGenerator</a></em><a aria-label="Click to copy this link" class="headerlink tooltipped tooltipped-ne" data-action="click-&gt;clipboard#copyHeaderLink" data-controller="clipboard" href="#fortuna.prob_model.likelihood.classification.ClassificationLikelihood.rng">¶</a></dt>
<dd>
<p>Invoke the random number generator object.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>The random number generator object.</p>
</dd>
</dl>
</dd></dl>
<dl class="py method code-definition">
<dt class="sig sig-object py" id="fortuna.prob_model.likelihood.classification.ClassificationLikelihood.sample">
<code class="sig-name descname">sample</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">n_target_samples</span></em>, <em class="sig-param"><span class="n">params</span></em>, <em class="sig-param"><span class="n">inputs_loader</span></em>, <em class="sig-param"><span class="n">mutable</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">calib_params</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">calib_mutable</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">return_aux</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">rng</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a aria-label="Click to copy this link" class="headerlink tooltipped tooltipped-ne" data-action="click-&gt;clipboard#copyHeaderLink" data-controller="clipboard" href="#fortuna.prob_model.likelihood.classification.ClassificationLikelihood.sample">¶</a></dt>
<dd>
<p>Sample target variables from the likelihood function for each input variable.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_target_samples</strong> (<em>int</em>) – The number of samples to draw from the likelihood for each input data point.</p></li>
<li><p><strong>params</strong> (<em>Params</em>) – The random parameters of the probabilistic model.</p></li>
<li><p><strong>inputs_loader</strong> (<a class="reference internal" href="../data_loader.html#fortuna.data.loader.InputsLoader" title="fortuna.data.loader.InputsLoader"><em>InputsLoader</em></a>) – A loader of input data points.</p></li>
<li><p><strong>mutable</strong> (<em>Optional</em><em>[</em><em>Mutable</em><em>]</em>) – The mutable objects used to evaluate the models.</p></li>
<li><p><strong>calib_params</strong> (<em>Optional</em><em>[</em><em>CalibParams</em><em>]</em>) – The calibration parameters of the probabilistic model.</p></li>
<li><p><strong>calib_mutable</strong> (<em>Optional</em><em>[</em><em>CalibMutable</em><em>]</em>) – The calibration mutable objects used to evaluate the calibrators.</p></li>
<li><p><strong>return_aux</strong> (<em>Optional</em><em>[</em><em>List</em><em>[</em><em>str</em><em>]</em><em>]</em>) – The auxiliary objects to return. We support ‘outputs’. If this argument is not given, no auxiliary object
is returned.</p></li>
<li><p><strong>rng</strong> (<em>Optional</em><em>[</em><em>PRNGKeyArray</em><em>]</em>) – A random number generator. If not passed, this will be taken from the attributes of this class.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The samples of the target variable for each input. If <cite>return_aux</cite> is given, the corresponding auxiliary
objects are also returned.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Union[jnp.ndarray, Tuple[jnp.ndarray, dict]]</p>
</dd>
</dl>
</dd></dl>
<dl class="py method code-definition">
<dt class="sig sig-object py" id="fortuna.prob_model.likelihood.classification.ClassificationLikelihood.std">
<code class="sig-name descname">std</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">params</span></em>, <em class="sig-param"><span class="n">inputs_loader</span></em>, <em class="sig-param"><span class="n">mutable</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">calib_params</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">calib_mutable</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">variance</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a aria-label="Click to copy this link" class="headerlink tooltipped tooltipped-ne" data-action="click-&gt;clipboard#copyHeaderLink" data-controller="clipboard" href="#fortuna.prob_model.likelihood.classification.ClassificationLikelihood.std">¶</a></dt>
<dd>
<p>Estimate the likelihood standard deviation of the target variable, that is</p>
<div class="math notranslate nohighlight">
\[\sqrt{\text{Var}_{Y|w,x}[Y]},\]</div>
<dl class="simple">
<dt>where:</dt><dd><ul class="simple">
<li><p><span class="math notranslate nohighlight">\(x\)</span> is an observed input variable;</p></li>
<li><p><span class="math notranslate nohighlight">\(Y\)</span> is a random target variable;</p></li>
<li><p><span class="math notranslate nohighlight">\(w\)</span> denotes the observed model parameters.</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<em>Params</em>) – The random parameters of the probabilistic model.</p></li>
<li><p><strong>inputs_loader</strong> (<a class="reference internal" href="../data_loader.html#fortuna.data.loader.InputsLoader" title="fortuna.data.loader.InputsLoader"><em>InputsLoader</em></a>) – A loader of input data points.</p></li>
<li><p><strong>mutable</strong> (<em>Optional</em><em>[</em><em>Mutable</em><em>]</em>) – The mutable objects used to evaluate the models.</p></li>
<li><p><strong>calib_params</strong> (<em>Optional</em><em>[</em><em>CalibParams</em><em>]</em>) – The calibration parameters of the probabilistic model.</p></li>
<li><p><strong>calib_mutable</strong> (<em>Optional</em><em>[</em><em>CalibMutable</em><em>]</em>) – The calibration mutable objects used to evaluate the calibrators.</p></li>
<li><p><strong>variance</strong> (<em>Optional</em><em>[</em><em>jnp.ndarray</em><em>]</em>) – An estimate of the likelihood variance for each input.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>An estimate of the likelihood standard deviation for each input.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>jnp.ndarray</p>
</dd>
</dl>
</dd></dl>
<dl class="py method code-definition">
<dt class="sig sig-object py" id="fortuna.prob_model.likelihood.classification.ClassificationLikelihood.variance">
<code class="sig-name descname">variance</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">params</span></em>, <em class="sig-param"><span class="n">inputs_loader</span></em>, <em class="sig-param"><span class="n">mutable</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">calib_params</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">calib_mutable</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/fortuna/prob_model/likelihood/classification.html#ClassificationLikelihood.variance"><span class="viewcode-link">[source]</span></a><a aria-label="Click to copy this link" class="headerlink tooltipped tooltipped-ne" data-action="click-&gt;clipboard#copyHeaderLink" data-controller="clipboard" href="#fortuna.prob_model.likelihood.classification.ClassificationLikelihood.variance">¶</a></dt>
<dd>
<p>Estimate the likelihood variance of the one-hot encoded target variable, that is</p>
<div class="math notranslate nohighlight">
\[\text{Var}_{\tilde{Y}|w,x}[\tilde{Y}],\]</div>
<dl class="simple">
<dt>where:</dt><dd><ul class="simple">
<li><p><span class="math notranslate nohighlight">\(x\)</span> is an observed input variable;</p></li>
<li><p><span class="math notranslate nohighlight">\(\tilde{Y}\)</span> is a one-hot encoded random target variable;</p></li>
<li><p><span class="math notranslate nohighlight">\(w\)</span> denotes the observed model parameters.</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<em>Params</em>) – The random parameters of the probabilistic model.</p></li>
<li><p><strong>inputs_loader</strong> (<a class="reference internal" href="../data_loader.html#fortuna.data.loader.InputsLoader" title="fortuna.data.loader.InputsLoader"><em>InputsLoader</em></a>) – A loader of input data points.</p></li>
<li><p><strong>mutable</strong> (<em>Optional</em><em>[</em><em>Mutable</em><em>]</em>) – The mutable objects used to evaluate the models.</p></li>
<li><p><strong>calib_params</strong> (<em>Optional</em><em>[</em><em>CalibParams</em><em>]</em>) – The calibration parameters of the probabilistic model.</p></li>
<li><p><strong>calib_mutable</strong> (<em>Optional</em><em>[</em><em>CalibMutable</em><em>]</em>) – The calibration mutable objects used to evaluate the calibrators.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>An estimate of the likelihood variance for each input.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>jnp.ndarray</p>
</dd>
</dl>
</dd></dl>
</dd></dl>
<span class="target" id="module-fortuna.prob_model.likelihood.regression"><span id="likelihood-regression"></span></span><dl class="py class code-definition">
<dt class="sig sig-object py" id="fortuna.prob_model.likelihood.regression.RegressionLikelihood">
<em class="property">class<span class="w"> </span></em><code class="sig-prename descclassname">fortuna.prob_model.likelihood.regression.</code><code class="sig-name descname">RegressionLikelihood</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model_manager</span></em>, <em class="sig-param"><span class="n">prob_output_layer</span></em>, <em class="sig-param"><span class="n">output_calib_manager</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/fortuna/prob_model/likelihood/regression.html#RegressionLikelihood"><span class="viewcode-link">[source]</span></a><a aria-label="Click to copy this link" class="headerlink tooltipped tooltipped-ne" data-action="click-&gt;clipboard#copyHeaderLink" data-controller="clipboard" href="#fortuna.prob_model.likelihood.regression.RegressionLikelihood">¶</a></dt>
<dd>
<p>A classification likelihood function class. In this class, the likelihood function is additionally assumed to
be a probability density function, i.e. positive and integrating to 1. The likelihood is formed by three
objects applied in sequence: the model manager, the output calibrator and the probabilistic output layer. The
model manager maps parameters and inputs to outputs. The output calibration takes outputs and returns some
calibrated version of them. The probabilistic output layer describes the probability distribution of the
calibrated outputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_manager</strong> (<a class="reference internal" href="../model/model_manager.html#fortuna.model.model_manager.base.ModelManager" title="fortuna.model.model_manager.base.ModelManager"><em>ModelManager</em></a>) – An model manager. This objects orchestrates the evaluation of the models.</p></li>
<li><p><strong>prob_output_layer</strong> (<a class="reference internal" href="../prob_output_layer.html#fortuna.prob_output_layer.base.ProbOutputLayer" title="fortuna.prob_output_layer.base.ProbOutputLayer"><em>ProbOutputLayer</em></a>) – A probabilistic output layer object. This object characterizes the probability distribution of the target
variable given the calibrated outputs.</p></li>
<li><p><strong>output_calib_manager</strong> (<em>OutputCalibManager</em>) – An output calibration manager object. It transforms outputs of the model manager into some
calibrated version of them.</p></li>
</ul>
</dd>
</dl>
<dl class="py method code-definition">
<dt class="sig sig-object py" id="fortuna.prob_model.likelihood.regression.RegressionLikelihood.entropy">
<code class="sig-name descname">entropy</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">params</span></em>, <em class="sig-param"><span class="n">inputs_loader</span></em>, <em class="sig-param"><span class="n">mutable</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">calib_params</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">calib_mutable</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">n_target_samples</span><span class="o">=</span><span class="default_value">30</span></em>, <em class="sig-param"><span class="n">rng</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/fortuna/prob_model/likelihood/regression.html#RegressionLikelihood.entropy"><span class="viewcode-link">[source]</span></a><a aria-label="Click to copy this link" class="headerlink tooltipped tooltipped-ne" data-action="click-&gt;clipboard#copyHeaderLink" data-controller="clipboard" href="#fortuna.prob_model.likelihood.regression.RegressionLikelihood.entropy">¶</a></dt>
<dd>
<p>Estimate the likelihood entropy, that is</p>
<div class="math notranslate nohighlight">
\[-\mathbb{E}_{Y|w,x}[\log p(Y|w,x)]\]</div>
<dl class="simple">
<dt>where:</dt><dd><ul class="simple">
<li><p><span class="math notranslate nohighlight">\(x\)</span> is an observed input variable;</p></li>
<li><p><span class="math notranslate nohighlight">\(Y\)</span> is a random target variable;</p></li>
<li><p><span class="math notranslate nohighlight">\(w\)</span> denotes the observed model parameters.</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<em>Params</em>) – The random parameters of the probabilistic model.</p></li>
<li><p><strong>inputs_loader</strong> (<a class="reference internal" href="../data_loader.html#fortuna.data.loader.InputsLoader" title="fortuna.data.loader.InputsLoader"><em>InputsLoader</em></a>) – A loader of input data points.</p></li>
<li><p><strong>mutable</strong> (<em>Optional</em><em>[</em><em>Mutable</em><em>]</em>) – The mutable objects used to evaluate the models.</p></li>
<li><p><strong>calib_params</strong> (<em>Optional</em><em>[</em><em>CalibParams</em><em>]</em>) – The calibration parameters of the probabilistic model.</p></li>
<li><p><strong>calib_mutable</strong> (<em>Optional</em><em>[</em><em>CalibMutable</em><em>]</em>) – The calibration mutable objects used to evaluate the calibrators.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>An estimate of the likelihood entropy for each input.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>jnp.ndarray</p>
</dd>
</dl>
</dd></dl>
<dl class="py method code-definition">
<dt class="sig sig-object py" id="fortuna.prob_model.likelihood.regression.RegressionLikelihood.log_prob">
<code class="sig-name descname">log_prob</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">params</span></em>, <em class="sig-param"><span class="n">data_loader</span></em>, <em class="sig-param"><span class="n">mutable</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">calib_params</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">calib_mutable</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">return_aux</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">calib</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">outputs</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a aria-label="Click to copy this link" class="headerlink tooltipped tooltipped-ne" data-action="click-&gt;clipboard#copyHeaderLink" data-controller="clipboard" href="#fortuna.prob_model.likelihood.regression.RegressionLikelihood.log_prob">¶</a></dt>
<dd>
<p>Evaluate the log-likelihood function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<em>Params</em>) – The random parameters of the probabilistic model.</p></li>
<li><p><strong>data_loader</strong> (<a class="reference internal" href="../data_loader.html#fortuna.data.loader.DataLoader" title="fortuna.data.loader.DataLoader"><em>DataLoader</em></a>) – A data loader.</p></li>
<li><p><strong>mutable</strong> (<em>Optional</em><em>[</em><em>Mutable</em><em>]</em>) – The mutable objects used to evaluate the models.</p></li>
<li><p><strong>calib_params</strong> (<em>Optional</em><em>[</em><em>CalibParams</em><em>]</em>) – The calibration parameters of the probabilistic model.</p></li>
<li><p><strong>calib_mutable</strong> (<em>Optional</em><em>[</em><em>CalibMutable</em><em>]</em>) – The calibration mutable objects used to evaluate the calibrators.</p></li>
<li><p><strong>return_aux</strong> (<em>Optional</em><em>[</em><em>List</em><em>[</em><em>str</em><em>]</em><em>]</em>) – The auxiliary objects to return. We support ‘outputs’ and ‘calib_mutable’. If this argument is not given,
no auxiliary object is returned.</p></li>
<li><p><strong>calib</strong> (<em>bool</em>) – Whether this method is called during calibration.</p></li>
<li><p><strong>outputs</strong> (<em>Optional</em><em>[</em><em>jnp.ndarray</em><em>]</em>) – Pre-computed batch of outputs.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The evaluation of the log-likelihood function. If <cite>return_aux</cite> is given, the corresponding auxiliary
objects are also returned.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Union[float, Tuple[float, dict]]</p>
</dd>
</dl>
</dd></dl>
<dl class="py method code-definition">
<dt class="sig sig-object py" id="fortuna.prob_model.likelihood.regression.RegressionLikelihood.mean">
<code class="sig-name descname">mean</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">params</span></em>, <em class="sig-param"><span class="n">inputs_loader</span></em>, <em class="sig-param"><span class="n">mutable</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">calib_params</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">calib_mutable</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/fortuna/prob_model/likelihood/regression.html#RegressionLikelihood.mean"><span class="viewcode-link">[source]</span></a><a aria-label="Click to copy this link" class="headerlink tooltipped tooltipped-ne" data-action="click-&gt;clipboard#copyHeaderLink" data-controller="clipboard" href="#fortuna.prob_model.likelihood.regression.RegressionLikelihood.mean">¶</a></dt>
<dd>
<p>Estimate the likelihood mean of the target variable, that is</p>
<div class="math notranslate nohighlight">
\[\mathbb{E}_{Y|w, x}[Y],\]</div>
<dl class="simple">
<dt>where:</dt><dd><ul class="simple">
<li><p><span class="math notranslate nohighlight">\(x\)</span> is an observed input variable;</p></li>
<li><p><span class="math notranslate nohighlight">\(Y\)</span> is a random target variable;</p></li>
<li><p><span class="math notranslate nohighlight">\(w\)</span> denotes the observed model parameters.</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<em>Params</em>) – The random parameters of the probabilistic model.</p></li>
<li><p><strong>inputs_loader</strong> (<a class="reference internal" href="../data_loader.html#fortuna.data.loader.InputsLoader" title="fortuna.data.loader.InputsLoader"><em>InputsLoader</em></a>) – A loader of input data points.</p></li>
<li><p><strong>mutable</strong> (<em>Optional</em><em>[</em><em>Mutable</em><em>]</em>) – The mutable objects used to evaluate the models.</p></li>
<li><p><strong>calib_params</strong> (<em>Optional</em><em>[</em><em>CalibParams</em><em>]</em>) – The calibration parameters of the probabilistic model.</p></li>
<li><p><strong>calib_mutable</strong> (<em>Optional</em><em>[</em><em>CalibMutable</em><em>]</em>) – The calibration mutable objects used to evaluate the calibrators.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>An estimate of the likelihood mean for each input.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>jnp.ndarray</p>
</dd>
</dl>
</dd></dl>
<dl class="py method code-definition">
<dt class="sig sig-object py" id="fortuna.prob_model.likelihood.regression.RegressionLikelihood.mode">
<code class="sig-name descname">mode</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">params</span></em>, <em class="sig-param"><span class="n">inputs_loader</span></em>, <em class="sig-param"><span class="n">mutable</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">calib_params</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">calib_mutable</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/fortuna/prob_model/likelihood/regression.html#RegressionLikelihood.mode"><span class="viewcode-link">[source]</span></a><a aria-label="Click to copy this link" class="headerlink tooltipped tooltipped-ne" data-action="click-&gt;clipboard#copyHeaderLink" data-controller="clipboard" href="#fortuna.prob_model.likelihood.regression.RegressionLikelihood.mode">¶</a></dt>
<dd>
<p>Estimate the likelihood mode of the target variable, that is</p>
<div class="math notranslate nohighlight">
\[\text{argmax}_y\ p(y|w, x),\]</div>
<dl class="simple">
<dt>where:</dt><dd><ul class="simple">
<li><p><span class="math notranslate nohighlight">\(x\)</span> is an observed input variable;</p></li>
<li><p><span class="math notranslate nohighlight">\(w\)</span> denotes the observed model parameters;</p></li>
<li><p><span class="math notranslate nohighlight">\(y\)</span> is the target variable to optimize upon.</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<em>Params</em>) – The random parameters of the probabilistic model.</p></li>
<li><p><strong>inputs_loader</strong> (<a class="reference internal" href="../data_loader.html#fortuna.data.loader.InputsLoader" title="fortuna.data.loader.InputsLoader"><em>InputsLoader</em></a>) – A loader of input data points.</p></li>
<li><p><strong>mutable</strong> (<em>Optional</em><em>[</em><em>Mutable</em><em>]</em>) – The mutable objects used to evaluate the models.</p></li>
<li><p><strong>calib_params</strong> (<em>Optional</em><em>[</em><em>CalibParams</em><em>]</em>) – The calibration parameters of the probabilistic model.</p></li>
<li><p><strong>calib_mutable</strong> (<em>Optional</em><em>[</em><em>CalibMutable</em><em>]</em>) – The calibration mutable objects used to evaluate the calibrators.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>An estimate of the likelihood mean for each input.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>jnp.ndarray</p>
</dd>
</dl>
</dd></dl>
<dl class="py method code-definition">
<dt class="sig sig-object py" id="fortuna.prob_model.likelihood.regression.RegressionLikelihood.quantile">
<code class="sig-name descname">quantile</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">q</span></em>, <em class="sig-param"><span class="n">params</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">inputs_loader</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">mutable</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">calib_params</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">calib_mutable</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">n_target_samples</span><span class="o">=</span><span class="default_value">30</span></em>, <em class="sig-param"><span class="n">target_samples</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">rng</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/fortuna/prob_model/likelihood/regression.html#RegressionLikelihood.quantile"><span class="viewcode-link">[source]</span></a><a aria-label="Click to copy this link" class="headerlink tooltipped tooltipped-ne" data-action="click-&gt;clipboard#copyHeaderLink" data-controller="clipboard" href="#fortuna.prob_model.likelihood.regression.RegressionLikelihood.quantile">¶</a></dt>
<dd>
<p>Estimate the <cite>q</cite>-th quantiles of the likelihood function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q</strong> (<em>Union</em><em>[</em><em>float</em><em>, </em><em>jnp.ndarray</em><em>, </em><em>np.ndarray</em><em>]</em>) – Quantile or sequence of quantiles to compute, which must be between 0 and 1 inclusive.</p></li>
<li><p><strong>params</strong> (<em>Params</em>) – The random parameters of the probabilistic model.</p></li>
<li><p><strong>inputs_loader</strong> (<a class="reference internal" href="../data_loader.html#fortuna.data.loader.InputsLoader" title="fortuna.data.loader.InputsLoader"><em>InputsLoader</em></a>) – A loader of input data points.</p></li>
<li><p><strong>mutable</strong> (<em>Optional</em><em>[</em><em>Mutable</em><em>]</em>) – The mutable objects used to evaluate the models.</p></li>
<li><p><strong>calib_params</strong> (<em>Optional</em><em>[</em><em>CalibParams</em><em>]</em>) – The calibration parameters of the probabilistic model.</p></li>
<li><p><strong>calib_mutable</strong> (<em>Optional</em><em>[</em><em>CalibMutable</em><em>]</em>) – The calibration mutable objects used to evaluate the calibrators.</p></li>
<li><p><strong>n_target_samples</strong> (<em>int</em>) – Number of target samples to sample for each input data point.</p></li>
<li><p><strong>target_samples</strong> (<em>Optional</em><em>[</em><em>jnp.ndarray</em><em>] </em><em>= None</em>) – Samples of the target variable for each input, used to estimate the quantiles.</p></li>
<li><p><strong>rng</strong> (<em>Optional</em><em>[</em><em>PRNGKeyArray</em><em>]</em>) – A random number generator. If not passed, this will be taken from the attributes of this class.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Quantile estimate for each quantile and each input. If multiple quantiles <cite>q</cite> are given, the result’s
first axis is over different quantiles.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>jnp.ndarray</p>
</dd>
</dl>
</dd></dl>
<dl class="py property code-definition">
<dt class="sig sig-object py" id="fortuna.prob_model.likelihood.regression.RegressionLikelihood.rng">
<em class="property">property<span class="w"> </span></em><code class="sig-name descname">rng</code><em class="property"><span class="p">:</span><span class="w"> </span><a class="reference internal" href="../utils.html#fortuna.utils.random.RandomNumberGenerator" title="fortuna.utils.random.RandomNumberGenerator">RandomNumberGenerator</a></em><a aria-label="Click to copy this link" class="headerlink tooltipped tooltipped-ne" data-action="click-&gt;clipboard#copyHeaderLink" data-controller="clipboard" href="#fortuna.prob_model.likelihood.regression.RegressionLikelihood.rng">¶</a></dt>
<dd>
<p>Invoke the random number generator object.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>The random number generator object.</p>
</dd>
</dl>
</dd></dl>
<dl class="py method code-definition">
<dt class="sig sig-object py" id="fortuna.prob_model.likelihood.regression.RegressionLikelihood.sample">
<code class="sig-name descname">sample</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">n_target_samples</span></em>, <em class="sig-param"><span class="n">params</span></em>, <em class="sig-param"><span class="n">inputs_loader</span></em>, <em class="sig-param"><span class="n">mutable</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">calib_params</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">calib_mutable</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">return_aux</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">rng</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a aria-label="Click to copy this link" class="headerlink tooltipped tooltipped-ne" data-action="click-&gt;clipboard#copyHeaderLink" data-controller="clipboard" href="#fortuna.prob_model.likelihood.regression.RegressionLikelihood.sample">¶</a></dt>
<dd>
<p>Sample target variables from the likelihood function for each input variable.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_target_samples</strong> (<em>int</em>) – The number of samples to draw from the likelihood for each input data point.</p></li>
<li><p><strong>params</strong> (<em>Params</em>) – The random parameters of the probabilistic model.</p></li>
<li><p><strong>inputs_loader</strong> (<a class="reference internal" href="../data_loader.html#fortuna.data.loader.InputsLoader" title="fortuna.data.loader.InputsLoader"><em>InputsLoader</em></a>) – A loader of input data points.</p></li>
<li><p><strong>mutable</strong> (<em>Optional</em><em>[</em><em>Mutable</em><em>]</em>) – The mutable objects used to evaluate the models.</p></li>
<li><p><strong>calib_params</strong> (<em>Optional</em><em>[</em><em>CalibParams</em><em>]</em>) – The calibration parameters of the probabilistic model.</p></li>
<li><p><strong>calib_mutable</strong> (<em>Optional</em><em>[</em><em>CalibMutable</em><em>]</em>) – The calibration mutable objects used to evaluate the calibrators.</p></li>
<li><p><strong>return_aux</strong> (<em>Optional</em><em>[</em><em>List</em><em>[</em><em>str</em><em>]</em><em>]</em>) – The auxiliary objects to return. We support ‘outputs’. If this argument is not given, no auxiliary object
is returned.</p></li>
<li><p><strong>rng</strong> (<em>Optional</em><em>[</em><em>PRNGKeyArray</em><em>]</em>) – A random number generator. If not passed, this will be taken from the attributes of this class.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The samples of the target variable for each input. If <cite>return_aux</cite> is given, the corresponding auxiliary
objects are also returned.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Union[jnp.ndarray, Tuple[jnp.ndarray, dict]]</p>
</dd>
</dl>
</dd></dl>
<dl class="py method code-definition">
<dt class="sig sig-object py" id="fortuna.prob_model.likelihood.regression.RegressionLikelihood.std">
<code class="sig-name descname">std</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">params</span></em>, <em class="sig-param"><span class="n">inputs_loader</span></em>, <em class="sig-param"><span class="n">mutable</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">calib_params</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">calib_mutable</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">variance</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a aria-label="Click to copy this link" class="headerlink tooltipped tooltipped-ne" data-action="click-&gt;clipboard#copyHeaderLink" data-controller="clipboard" href="#fortuna.prob_model.likelihood.regression.RegressionLikelihood.std">¶</a></dt>
<dd>
<p>Estimate the likelihood standard deviation of the target variable, that is</p>
<div class="math notranslate nohighlight">
\[\sqrt{\text{Var}_{Y|w,x}[Y]},\]</div>
<dl class="simple">
<dt>where:</dt><dd><ul class="simple">
<li><p><span class="math notranslate nohighlight">\(x\)</span> is an observed input variable;</p></li>
<li><p><span class="math notranslate nohighlight">\(Y\)</span> is a random target variable;</p></li>
<li><p><span class="math notranslate nohighlight">\(w\)</span> denotes the observed model parameters.</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<em>Params</em>) – The random parameters of the probabilistic model.</p></li>
<li><p><strong>inputs_loader</strong> (<a class="reference internal" href="../data_loader.html#fortuna.data.loader.InputsLoader" title="fortuna.data.loader.InputsLoader"><em>InputsLoader</em></a>) – A loader of input data points.</p></li>
<li><p><strong>mutable</strong> (<em>Optional</em><em>[</em><em>Mutable</em><em>]</em>) – The mutable objects used to evaluate the models.</p></li>
<li><p><strong>calib_params</strong> (<em>Optional</em><em>[</em><em>CalibParams</em><em>]</em>) – The calibration parameters of the probabilistic model.</p></li>
<li><p><strong>calib_mutable</strong> (<em>Optional</em><em>[</em><em>CalibMutable</em><em>]</em>) – The calibration mutable objects used to evaluate the calibrators.</p></li>
<li><p><strong>variance</strong> (<em>Optional</em><em>[</em><em>jnp.ndarray</em><em>]</em>) – An estimate of the likelihood variance for each input.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>An estimate of the likelihood standard deviation for each input.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>jnp.ndarray</p>
</dd>
</dl>
</dd></dl>
<dl class="py method code-definition">
<dt class="sig sig-object py" id="fortuna.prob_model.likelihood.regression.RegressionLikelihood.variance">
<code class="sig-name descname">variance</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">params</span></em>, <em class="sig-param"><span class="n">inputs_loader</span></em>, <em class="sig-param"><span class="n">mutable</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">calib_params</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">calib_mutable</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/fortuna/prob_model/likelihood/regression.html#RegressionLikelihood.variance"><span class="viewcode-link">[source]</span></a><a aria-label="Click to copy this link" class="headerlink tooltipped tooltipped-ne" data-action="click-&gt;clipboard#copyHeaderLink" data-controller="clipboard" href="#fortuna.prob_model.likelihood.regression.RegressionLikelihood.variance">¶</a></dt>
<dd>
<p>Estimate the likelihood variance of the target variable, that is</p>
<div class="math notranslate nohighlight">
\[\text{Var}_{Y|w,x}[Y],\]</div>
<dl class="simple">
<dt>where:</dt><dd><ul class="simple">
<li><p><span class="math notranslate nohighlight">\(x\)</span> is an observed input variable;</p></li>
<li><p><span class="math notranslate nohighlight">\(Y\)</span> is a random target variable;</p></li>
<li><p><span class="math notranslate nohighlight">\(w\)</span> denotes the observed model parameters.</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<em>Params</em>) – The random parameters of the probabilistic model.</p></li>
<li><p><strong>inputs_loader</strong> (<a class="reference internal" href="../data_loader.html#fortuna.data.loader.InputsLoader" title="fortuna.data.loader.InputsLoader"><em>InputsLoader</em></a>) – A loader of input data points.</p></li>
<li><p><strong>mutable</strong> (<em>Optional</em><em>[</em><em>Mutable</em><em>]</em>) – The mutable objects used to evaluate the models.</p></li>
<li><p><strong>calib_params</strong> (<em>Optional</em><em>[</em><em>CalibParams</em><em>]</em>) – The calibration parameters of the probabilistic model.</p></li>
<li><p><strong>calib_mutable</strong> (<em>Optional</em><em>[</em><em>CalibMutable</em><em>]</em>) – The calibration mutable objects used to evaluate the calibrators.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>An estimate of the likelihood variance for each input.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>jnp.ndarray</p>
</dd>
</dl>
</dd></dl>
</dd></dl>
<span class="target" id="module-fortuna.prob_model.likelihood.base"><span id="likelihood"></span></span><dl class="py class code-definition">
<dt class="sig sig-object py" id="fortuna.prob_model.likelihood.base.Likelihood">
<em class="property">class<span class="w"> </span></em><code class="sig-prename descclassname">fortuna.prob_model.likelihood.base.</code><code class="sig-name descname">Likelihood</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model_manager</span></em>, <em class="sig-param"><span class="n">prob_output_layer</span></em>, <em class="sig-param"><span class="n">output_calib_manager</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/fortuna/prob_model/likelihood/base.html#Likelihood"><span class="viewcode-link">[source]</span></a><a aria-label="Click to copy this link" class="headerlink tooltipped tooltipped-ne" data-action="click-&gt;clipboard#copyHeaderLink" data-controller="clipboard" href="#fortuna.prob_model.likelihood.base.Likelihood">¶</a></dt>
<dd>
<p>A likelihood function abstract class. In this class, the likelihood function is additionally assumed to be a
probability density function, i.e. positive and integrating to 1. The likelihood is formed by three objects
applied in sequence: the model manager, the output calibrator and the probabilistic output layer. The output
maker maps parameters and inputs to outputs. The output calibration takes outputs and returns some calibrated
version of them. The probabilistic output layer describes the probability distribution of the calibrated
outputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_manager</strong> (<a class="reference internal" href="../model/model_manager.html#fortuna.model.model_manager.base.ModelManager" title="fortuna.model.model_manager.base.ModelManager"><em>ModelManager</em></a>) – An model manager. This objects orchestrates the evaluation of the models.</p></li>
<li><p><strong>prob_output_layer</strong> (<a class="reference internal" href="../prob_output_layer.html#fortuna.prob_output_layer.base.ProbOutputLayer" title="fortuna.prob_output_layer.base.ProbOutputLayer"><em>ProbOutputLayer</em></a>) – A probabilistic output layer object. This object characterizes the probability distribution of the
target variable given the calibrated outputs.</p></li>
<li><p><strong>output_calib_manager</strong> (<em>OutputCalibManager</em>) – An output calibration manager object. It transforms outputs of the model manager into some
calibrated version of them.</p></li>
</ul>
</dd>
</dl>
<dl class="py method code-definition">
<dt class="sig sig-object py" id="fortuna.prob_model.likelihood.base.Likelihood.entropy">
<em class="property">abstract<span class="w"> </span></em><code class="sig-name descname">entropy</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">params</span></em>, <em class="sig-param"><span class="n">inputs_loader</span></em>, <em class="sig-param"><span class="n">mutable</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">calib_params</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">calib_mutable</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/fortuna/prob_model/likelihood/base.html#Likelihood.entropy"><span class="viewcode-link">[source]</span></a><a aria-label="Click to copy this link" class="headerlink tooltipped tooltipped-ne" data-action="click-&gt;clipboard#copyHeaderLink" data-controller="clipboard" href="#fortuna.prob_model.likelihood.base.Likelihood.entropy">¶</a></dt>
<dd>
<p>Estimate the likelihood entropy, that is</p>
<div class="math notranslate nohighlight">
\[-\mathbb{E}_{Y|w,x}[\log p(Y|w,x)]\]</div>
<dl class="simple">
<dt>where:</dt><dd><ul class="simple">
<li><p><span class="math notranslate nohighlight">\(x\)</span> is an observed input variable;</p></li>
<li><p><span class="math notranslate nohighlight">\(Y\)</span> is a random target variable;</p></li>
<li><p><span class="math notranslate nohighlight">\(w\)</span> denotes the observed model parameters.</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<em>Params</em>) – The random parameters of the probabilistic model.</p></li>
<li><p><strong>inputs_loader</strong> (<a class="reference internal" href="../data_loader.html#fortuna.data.loader.InputsLoader" title="fortuna.data.loader.InputsLoader"><em>InputsLoader</em></a>) – A loader of input data points.</p></li>
<li><p><strong>mutable</strong> (<em>Optional</em><em>[</em><em>Mutable</em><em>]</em>) – The mutable objects used to evaluate the models.</p></li>
<li><p><strong>calib_params</strong> (<em>Optional</em><em>[</em><em>CalibParams</em><em>]</em>) – The calibration parameters of the probabilistic model.</p></li>
<li><p><strong>calib_mutable</strong> (<em>Optional</em><em>[</em><em>CalibMutable</em><em>]</em>) – The calibration mutable objects used to evaluate the calibrators.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>An estimate of the likelihood entropy for each input.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>jnp.ndarray</p>
</dd>
</dl>
</dd></dl>
<dl class="py method code-definition">
<dt class="sig sig-object py" id="fortuna.prob_model.likelihood.base.Likelihood.log_prob">
<code class="sig-name descname">log_prob</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">params</span></em>, <em class="sig-param"><span class="n">data_loader</span></em>, <em class="sig-param"><span class="n">mutable</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">calib_params</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">calib_mutable</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">return_aux</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">calib</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">outputs</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/fortuna/prob_model/likelihood/base.html#Likelihood.log_prob"><span class="viewcode-link">[source]</span></a><a aria-label="Click to copy this link" class="headerlink tooltipped tooltipped-ne" data-action="click-&gt;clipboard#copyHeaderLink" data-controller="clipboard" href="#fortuna.prob_model.likelihood.base.Likelihood.log_prob">¶</a></dt>
<dd>
<p>Evaluate the log-likelihood function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<em>Params</em>) – The random parameters of the probabilistic model.</p></li>
<li><p><strong>data_loader</strong> (<a class="reference internal" href="../data_loader.html#fortuna.data.loader.DataLoader" title="fortuna.data.loader.DataLoader"><em>DataLoader</em></a>) – A data loader.</p></li>
<li><p><strong>mutable</strong> (<em>Optional</em><em>[</em><em>Mutable</em><em>]</em>) – The mutable objects used to evaluate the models.</p></li>
<li><p><strong>calib_params</strong> (<em>Optional</em><em>[</em><em>CalibParams</em><em>]</em>) – The calibration parameters of the probabilistic model.</p></li>
<li><p><strong>calib_mutable</strong> (<em>Optional</em><em>[</em><em>CalibMutable</em><em>]</em>) – The calibration mutable objects used to evaluate the calibrators.</p></li>
<li><p><strong>return_aux</strong> (<em>Optional</em><em>[</em><em>List</em><em>[</em><em>str</em><em>]</em><em>]</em>) – The auxiliary objects to return. We support ‘outputs’ and ‘calib_mutable’. If this argument is not given,
no auxiliary object is returned.</p></li>
<li><p><strong>calib</strong> (<em>bool</em>) – Whether this method is called during calibration.</p></li>
<li><p><strong>outputs</strong> (<em>Optional</em><em>[</em><em>jnp.ndarray</em><em>]</em>) – Pre-computed batch of outputs.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The evaluation of the log-likelihood function. If <cite>return_aux</cite> is given, the corresponding auxiliary
objects are also returned.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Union[float, Tuple[float, dict]]</p>
</dd>
</dl>
</dd></dl>
<dl class="py method code-definition">
<dt class="sig sig-object py" id="fortuna.prob_model.likelihood.base.Likelihood.mean">
<em class="property">abstract<span class="w"> </span></em><code class="sig-name descname">mean</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">params</span></em>, <em class="sig-param"><span class="n">inputs_loader</span></em>, <em class="sig-param"><span class="n">mutable</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">calib_params</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">calib_mutable</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/fortuna/prob_model/likelihood/base.html#Likelihood.mean"><span class="viewcode-link">[source]</span></a><a aria-label="Click to copy this link" class="headerlink tooltipped tooltipped-ne" data-action="click-&gt;clipboard#copyHeaderLink" data-controller="clipboard" href="#fortuna.prob_model.likelihood.base.Likelihood.mean">¶</a></dt>
<dd>
<p>Estimate the likelihood mean of the target variable, that is</p>
<div class="math notranslate nohighlight">
\[\mathbb{E}_{Y|w, x}[Y],\]</div>
<dl class="simple">
<dt>where:</dt><dd><ul class="simple">
<li><p><span class="math notranslate nohighlight">\(x\)</span> is an observed input variable;</p></li>
<li><p><span class="math notranslate nohighlight">\(Y\)</span> is a random target variable;</p></li>
<li><p><span class="math notranslate nohighlight">\(w\)</span> denotes the observed model parameters.</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<em>Params</em>) – The random parameters of the probabilistic model.</p></li>
<li><p><strong>inputs_loader</strong> (<a class="reference internal" href="../data_loader.html#fortuna.data.loader.InputsLoader" title="fortuna.data.loader.InputsLoader"><em>InputsLoader</em></a>) – A loader of input data points.</p></li>
<li><p><strong>mutable</strong> (<em>Optional</em><em>[</em><em>Mutable</em><em>]</em>) – The mutable objects used to evaluate the models.</p></li>
<li><p><strong>calib_params</strong> (<em>Optional</em><em>[</em><em>CalibParams</em><em>]</em>) – The calibration parameters of the probabilistic model.</p></li>
<li><p><strong>calib_mutable</strong> (<em>Optional</em><em>[</em><em>CalibMutable</em><em>]</em>) – The calibration mutable objects used to evaluate the calibrators.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>An estimate of the likelihood mean for each input.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>jnp.ndarray</p>
</dd>
</dl>
</dd></dl>
<dl class="py method code-definition">
<dt class="sig sig-object py" id="fortuna.prob_model.likelihood.base.Likelihood.mode">
<em class="property">abstract<span class="w"> </span></em><code class="sig-name descname">mode</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">params</span></em>, <em class="sig-param"><span class="n">inputs_loader</span></em>, <em class="sig-param"><span class="n">mutable</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">calib_params</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">calib_mutable</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/fortuna/prob_model/likelihood/base.html#Likelihood.mode"><span class="viewcode-link">[source]</span></a><a aria-label="Click to copy this link" class="headerlink tooltipped tooltipped-ne" data-action="click-&gt;clipboard#copyHeaderLink" data-controller="clipboard" href="#fortuna.prob_model.likelihood.base.Likelihood.mode">¶</a></dt>
<dd>
<p>Estimate the likelihood mode of the target variable, that is</p>
<div class="math notranslate nohighlight">
\[\text{argmax}_y\ p(y|w, x),\]</div>
<dl class="simple">
<dt>where:</dt><dd><ul class="simple">
<li><p><span class="math notranslate nohighlight">\(x\)</span> is an observed input variable;</p></li>
<li><p><span class="math notranslate nohighlight">\(w\)</span> denotes the observed model parameters;</p></li>
<li><p><span class="math notranslate nohighlight">\(y\)</span> is the target variable to optimize upon.</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<em>Params</em>) – The random parameters of the probabilistic model.</p></li>
<li><p><strong>inputs_loader</strong> (<a class="reference internal" href="../data_loader.html#fortuna.data.loader.InputsLoader" title="fortuna.data.loader.InputsLoader"><em>InputsLoader</em></a>) – A loader of input data points.</p></li>
<li><p><strong>mutable</strong> (<em>Optional</em><em>[</em><em>Mutable</em><em>]</em>) – The mutable objects used to evaluate the models.</p></li>
<li><p><strong>calib_params</strong> (<em>Optional</em><em>[</em><em>CalibParams</em><em>]</em>) – The calibration parameters of the probabilistic model.</p></li>
<li><p><strong>calib_mutable</strong> (<em>Optional</em><em>[</em><em>CalibMutable</em><em>]</em>) – The calibration mutable objects used to evaluate the calibrators.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>An estimate of the likelihood mean for each input.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>jnp.ndarray</p>
</dd>
</dl>
</dd></dl>
<dl class="py property code-definition">
<dt class="sig sig-object py" id="fortuna.prob_model.likelihood.base.Likelihood.rng">
<em class="property">property<span class="w"> </span></em><code class="sig-name descname">rng</code><em class="property"><span class="p">:</span><span class="w"> </span><a class="reference internal" href="../utils.html#fortuna.utils.random.RandomNumberGenerator" title="fortuna.utils.random.RandomNumberGenerator">RandomNumberGenerator</a></em><a aria-label="Click to copy this link" class="headerlink tooltipped tooltipped-ne" data-action="click-&gt;clipboard#copyHeaderLink" data-controller="clipboard" href="#fortuna.prob_model.likelihood.base.Likelihood.rng">¶</a></dt>
<dd>
<p>Invoke the random number generator object.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>The random number generator object.</p>
</dd>
</dl>
</dd></dl>
<dl class="py method code-definition">
<dt class="sig sig-object py" id="fortuna.prob_model.likelihood.base.Likelihood.sample">
<code class="sig-name descname">sample</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">n_target_samples</span></em>, <em class="sig-param"><span class="n">params</span></em>, <em class="sig-param"><span class="n">inputs_loader</span></em>, <em class="sig-param"><span class="n">mutable</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">calib_params</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">calib_mutable</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">return_aux</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">rng</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/fortuna/prob_model/likelihood/base.html#Likelihood.sample"><span class="viewcode-link">[source]</span></a><a aria-label="Click to copy this link" class="headerlink tooltipped tooltipped-ne" data-action="click-&gt;clipboard#copyHeaderLink" data-controller="clipboard" href="#fortuna.prob_model.likelihood.base.Likelihood.sample">¶</a></dt>
<dd>
<p>Sample target variables from the likelihood function for each input variable.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_target_samples</strong> (<em>int</em>) – The number of samples to draw from the likelihood for each input data point.</p></li>
<li><p><strong>params</strong> (<em>Params</em>) – The random parameters of the probabilistic model.</p></li>
<li><p><strong>inputs_loader</strong> (<a class="reference internal" href="../data_loader.html#fortuna.data.loader.InputsLoader" title="fortuna.data.loader.InputsLoader"><em>InputsLoader</em></a>) – A loader of input data points.</p></li>
<li><p><strong>mutable</strong> (<em>Optional</em><em>[</em><em>Mutable</em><em>]</em>) – The mutable objects used to evaluate the models.</p></li>
<li><p><strong>calib_params</strong> (<em>Optional</em><em>[</em><em>CalibParams</em><em>]</em>) – The calibration parameters of the probabilistic model.</p></li>
<li><p><strong>calib_mutable</strong> (<em>Optional</em><em>[</em><em>CalibMutable</em><em>]</em>) – The calibration mutable objects used to evaluate the calibrators.</p></li>
<li><p><strong>return_aux</strong> (<em>Optional</em><em>[</em><em>List</em><em>[</em><em>str</em><em>]</em><em>]</em>) – The auxiliary objects to return. We support ‘outputs’. If this argument is not given, no auxiliary object
is returned.</p></li>
<li><p><strong>rng</strong> (<em>Optional</em><em>[</em><em>PRNGKeyArray</em><em>]</em>) – A random number generator. If not passed, this will be taken from the attributes of this class.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The samples of the target variable for each input. If <cite>return_aux</cite> is given, the corresponding auxiliary
objects are also returned.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Union[jnp.ndarray, Tuple[jnp.ndarray, dict]]</p>
</dd>
</dl>
</dd></dl>
<dl class="py method code-definition">
<dt class="sig sig-object py" id="fortuna.prob_model.likelihood.base.Likelihood.std">
<code class="sig-name descname">std</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">params</span></em>, <em class="sig-param"><span class="n">inputs_loader</span></em>, <em class="sig-param"><span class="n">mutable</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">calib_params</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">calib_mutable</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">variance</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/fortuna/prob_model/likelihood/base.html#Likelihood.std"><span class="viewcode-link">[source]</span></a><a aria-label="Click to copy this link" class="headerlink tooltipped tooltipped-ne" data-action="click-&gt;clipboard#copyHeaderLink" data-controller="clipboard" href="#fortuna.prob_model.likelihood.base.Likelihood.std">¶</a></dt>
<dd>
<p>Estimate the likelihood standard deviation of the target variable, that is</p>
<div class="math notranslate nohighlight">
\[\sqrt{\text{Var}_{Y|w,x}[Y]},\]</div>
<dl class="simple">
<dt>where:</dt><dd><ul class="simple">
<li><p><span class="math notranslate nohighlight">\(x\)</span> is an observed input variable;</p></li>
<li><p><span class="math notranslate nohighlight">\(Y\)</span> is a random target variable;</p></li>
<li><p><span class="math notranslate nohighlight">\(w\)</span> denotes the observed model parameters.</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<em>Params</em>) – The random parameters of the probabilistic model.</p></li>
<li><p><strong>inputs_loader</strong> (<a class="reference internal" href="../data_loader.html#fortuna.data.loader.InputsLoader" title="fortuna.data.loader.InputsLoader"><em>InputsLoader</em></a>) – A loader of input data points.</p></li>
<li><p><strong>mutable</strong> (<em>Optional</em><em>[</em><em>Mutable</em><em>]</em>) – The mutable objects used to evaluate the models.</p></li>
<li><p><strong>calib_params</strong> (<em>Optional</em><em>[</em><em>CalibParams</em><em>]</em>) – The calibration parameters of the probabilistic model.</p></li>
<li><p><strong>calib_mutable</strong> (<em>Optional</em><em>[</em><em>CalibMutable</em><em>]</em>) – The calibration mutable objects used to evaluate the calibrators.</p></li>
<li><p><strong>variance</strong> (<em>Optional</em><em>[</em><em>jnp.ndarray</em><em>]</em>) – An estimate of the likelihood variance for each input.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>An estimate of the likelihood standard deviation for each input.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>jnp.ndarray</p>
</dd>
</dl>
</dd></dl>
<dl class="py method code-definition">
<dt class="sig sig-object py" id="fortuna.prob_model.likelihood.base.Likelihood.variance">
<em class="property">abstract<span class="w"> </span></em><code class="sig-name descname">variance</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">params</span></em>, <em class="sig-param"><span class="n">inputs_loader</span></em>, <em class="sig-param"><span class="n">mutable</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">calib_params</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">calib_mutable</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/fortuna/prob_model/likelihood/base.html#Likelihood.variance"><span class="viewcode-link">[source]</span></a><a aria-label="Click to copy this link" class="headerlink tooltipped tooltipped-ne" data-action="click-&gt;clipboard#copyHeaderLink" data-controller="clipboard" href="#fortuna.prob_model.likelihood.base.Likelihood.variance">¶</a></dt>
<dd>
<p>Estimate the likelihood variance of the target variable, that is</p>
<div class="math notranslate nohighlight">
\[\text{Var}_{Y|w,x}[Y],\]</div>
<dl class="simple">
<dt>where:</dt><dd><ul class="simple">
<li><p><span class="math notranslate nohighlight">\(x\)</span> is an observed input variable;</p></li>
<li><p><span class="math notranslate nohighlight">\(Y\)</span> is a random target variable;</p></li>
<li><p><span class="math notranslate nohighlight">\(w\)</span> denotes the observed model parameters.</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<em>Params</em>) – The random parameters of the probabilistic model.</p></li>
<li><p><strong>inputs_loader</strong> (<a class="reference internal" href="../data_loader.html#fortuna.data.loader.InputsLoader" title="fortuna.data.loader.InputsLoader"><em>InputsLoader</em></a>) – A loader of input data points.</p></li>
<li><p><strong>mutable</strong> (<em>Optional</em><em>[</em><em>Mutable</em><em>]</em>) – The mutable objects used to evaluate the models.</p></li>
<li><p><strong>calib_params</strong> (<em>Optional</em><em>[</em><em>CalibParams</em><em>]</em>) – The calibration parameters of the probabilistic model.</p></li>
<li><p><strong>calib_mutable</strong> (<em>Optional</em><em>[</em><em>CalibMutable</em><em>]</em>) – The calibration mutable objects used to evaluate the calibrators.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>An estimate of the likelihood variance for each input.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>jnp.ndarray</p>
</dd>
</dl>
</dd></dl>
</dd></dl>
</section>
</article>
<footer>
<div class="mt-20 mb-4 text-sm text-gray-700 print:mt-4">© 2022, AWS Made with <a href="https://www.sphinx-doc.org">Sphinx 5.3.0</a></div>
</footer></main>
<button class="fixed bottom-0 right-0 z-20 opacity-0 p-4 m-4 tracking-wide bg-gray-900 text-gray-100 transition transform transform-gpu duration-500 translate-y-full" data-action="search#hideSnackbar" data-search-target="snackbar">
  Clear highlights
</button><div class="fixed hidden inset-0 bg-black bg-opacity-50" data-action="click-&gt;sidebar#close" data-sidebar-target="screen">
</div>
</div>
<script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
<script src="../../_static/jquery.js"></script>
<script src="../../_static/underscore.js"></script>
<script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
<script src="../../_static/doctools.js"></script>
<script src="../../_static/sphinx_highlight.js"></script>
<script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
<script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
<script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script src="../../_static/theme.3051a0ec24cad00d4d88.js"></script>
</body>
</html>